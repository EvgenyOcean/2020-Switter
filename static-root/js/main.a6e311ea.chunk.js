(this.webpackJsonpr_tweeter=this.webpackJsonpr_tweeter||[]).push([[0],{37:function(e,t,a){e.exports=a(49)},43:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(26),i=a.n(r),o=(a(42),a(43),a(22)),s=a(18),c=a(21),u=a(27),d=a(28),m=a(7),f=a(36),h=a(35),w=l.a.createContext(),k=function(e){Object(f.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={dataset:{username:e.username,canTweet:e.canTweet,page:e.page,tweetId:e.tweetId,feedOwner:e.feedOwner},value:"",tweets:[],prev:"",next:"",count:0,tweetsPerPage:15},n.handleRetweet=n.handleRetweet.bind(Object(m.a)(n)),n.handleTweetAdd=n.handleTweetAdd.bind(Object(m.a)(n)),n.handleLikeClick=n.handleLikeClick.bind(Object(m.a)(n)),n.handleDeleteClick=n.handleDeleteClick.bind(Object(m.a)(n)),n.handleTextArea=n.handleTextArea.bind(Object(m.a)(n)),n.fetchSomeTweets=n.fetchSomeTweets.bind(Object(m.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.fetchSomeTweets()}},{key:"fetchSomeTweets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a="/api/tweets";t?a=t:"user"===this.state.dataset.page?a+="/?username=".concat(this.state.dataset.feedOwner):"detail"===this.state.dataset.page&&(a+="/".concat(this.state.dataset.tweetId)),fetch(a).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong!")})).then((function(t){if(t.results){var a=t.previous,n=t.next,l=t.count;t=t.results,Array.isArray(t)?e.setState({tweets:t,prev:a,next:n,count:l}):e.setState({tweets:[t]})}else Array.isArray(t)?e.setState({tweets:t}):e.setState({tweets:[t]});window.scrollTo(0,0)})).catch((function(e){console.log(e.message)}))}},{key:"handleTweetAdd",value:function(e){var t=this;e.preventDefault();var a={content:this.state.value};fetch("/api/tweets/add-tweet",{method:"POST",headers:{HTTP_X_REQUESTED_WITH:"XMLHttpRequest","X-Requested-With":"XMLHttpRequest","X-CSRFToken":g("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong!")})).then((function(e){var a=[e].concat(Object(c.a)(t.state.tweets));t.setState({tweets:a,value:""})})).catch((function(e){console.log(e)}))}},{key:"handleRetweet",value:function(e){var t=this;fetch("/api/tweets/tweet-action/".concat(e),{method:"POST",headers:{HTTP_X_REQUESTED_WITH:"XMLHttpRequest","X-Requested-With":"XMLHttpRequest","X-CSRFToken":g("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify({action:"retweet"})}).then((function(e){if(e.ok)return e.json();throw new Error("something went wrong!")})).then((function(e){if("home"===t.state.dataset.page){var a=[e].concat(Object(c.a)(t.state.tweets));t.setState({tweets:a})}else console.log("Tweet was successfully retweeted!")})).catch((function(e){console.log(e)}))}},{key:"handleDeleteClick",value:function(e){fetch("/api/tweets/".concat(e),{method:"DELETE",headers:{HTTP_X_REQUESTED_WITH:"XMLHttpRequest","X-Requested-With":"XMLHttpRequest","X-CSRFToken":g("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify({action:"delete"})}).then((function(e){if(e.ok)return e.json();throw new Error("something went wrong!")})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},{key:"handleLikeClick",value:function(e){var t,a,n=this;this.state.tweets.length>1?t=this.state.tweets.find((function(t){return t.id===e}))?this.state.tweets.find((function(t){return t.id===e})).likes.user_liked?"dislike":"like":this.state.tweets.find((function(t){return!!t.original&&t.original.id===e})).original.likes.user_liked?"dislike":"like":(console.log(e),this.state.tweets[0].id===e?(t=this.state.tweets[0].likes.user_liked?"dislike":"like",a="main"):(t=this.state.tweets[0].original.likes.user_liked?"dislike":"like",a="original")),fetch("/api/tweets/tweet-action/".concat(e),{method:"POST",headers:{HTTP_X_REQUESTED_WITH:"XMLHttpRequest","X-Requested-With":"XMLHttpRequest","X-CSRFToken":g("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify({action:t})}).then((function(e){if(e.ok)return e.json();throw new Error("something went wrong!")})).then((function(t){var l,r=t.likes,i=JSON.stringify(n.state.tweets);if(i=JSON.parse(i),"detail"===n.state.dataset.page)return"main"===a?(i[0].likes.likes=r,i[0].likes.user_liked=!i[0].likes.user_liked):(i[0].original.likes.likes=r,i[0].original.likes.user_liked=!i[0].original.likes.user_liked),void n.setState({tweets:i});if(i.find((function(t){return t.id===e}))){(l=i.find((function(t){return t.id===e}))).likes.likes=r,l.likes.user_liked=!l.likes.user_liked;var o=i.filter((function(t){return!!t.original&&t.original.id===e}));if(o){var c,u=Object(s.a)(o);try{for(u.s();!(c=u.n()).done;){var d=c.value;d.original.likes.likes=r,d.original.likes.user_liked=!d.original.likes.user_liked}}catch(k){u.e(k)}finally{u.f()}}}else{var m=i.filter((function(t){return!!t.original&&t.original.id===e}));if(m){var f,h=Object(s.a)(m);try{for(h.s();!(f=h.n()).done;){var w=f.value;w.original.likes.likes=r,w.original.likes.user_liked=!w.original.likes.user_liked}}catch(k){h.e(k)}finally{h.f()}}}n.setState({tweets:i})})).catch((function(e){console.log(e)}))}},{key:"handleTextArea",value:function(e){var t=e.target.value;this.setState({value:t})}},{key:"render",value:function(){return l.a.createElement(w.Provider,{value:Object(o.a)(Object(o.a)({},this.state),{},{handleLikeClick:this.handleLikeClick,handleTweetAdd:this.handleTweetAdd,handleRetweet:this.handleRetweet,handleTextArea:this.handleTextArea,handleDeleteClick:this.handleDeleteClick,fetchSomeTweets:this.fetchSomeTweets})},this.props.children)}}]),a}(l.a.Component);function g(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),n=0;n<a.length;n++){var l=a[n].trim();if(l.substring(0,e.length+1)===e+"="){t=decodeURIComponent(l.substring(e.length+1));break}}return t}var E=function(e){return l.a.createElement("div",{className:"py-3 bg-warning mb-3"},"Hello from Navbar")},v=a(5),p=a(8),b=a(11),T=a(6);var C=function(e){var t=e.value;return l.a.createElement(b.a,null,l.a.createElement(T.a,{xs:10,lg:8,className:"mx-auto mb-5 px-0"},l.a.createElement(v.a,{onSubmit:e.handleTweetAdd},l.a.createElement(v.a.Group,{controlId:"exampleForm.ControlTextarea1"},l.a.createElement(v.a.Label,null,"Create New Tweet:"),l.a.createElement(v.a.Control,{as:"textarea",rows:"3",value:t,onChange:function(t){e.handleTextArea(t)}})),l.a.createElement(p.a,{variant:"primary",type:"submit"},"Submit"))))},y=a(29),S=a(30),x=a(19);function R(){var e=Object(y.a)(["\n  // background-color: red; \n"]);return R=function(){return e},e}var j=Object(S.a)(p.a)(R()),O=function(e){var t=e.dataset,a=e.tweet,n=e.tweet.original;return l.a.createElement(T.a,{xs:10,lg:8,className:"mx-auto border border-success py-3 mb-3"},l.a.createElement("div",{className:"media"},l.a.createElement("div",{className:"media-body"},l.a.createElement("div",null,l.a.createElement("a",{href:"/"+a.owner,className:"mt-0 text-info"},a.owner)),a.id," == ",a.content,n&&l.a.createElement("div",{className:"media mt-3 ml-5 border border-primary p-3 mb-3"},l.a.createElement("div",{className:"media-body"},l.a.createElement("div",null,l.a.createElement("a",{href:"/"+n.owner,className:"mt-0 text-info"},n.owner)),n.content),l.a.createElement(x.a,{"aria-label":"Basic example"},l.a.createElement(j,{variant:n.likes.user_liked?"info":"primary",onClick:function(){e.handleLikeClick(n.id)}},"Like ",n.likes.likes),l.a.createElement(j,{variant:"success",onClick:e.handleRetweet.bind(null,n.id)},"Retweet"),("home"===t.page||"user"===t.page)&&l.a.createElement("a",{href:"/"+a.original.id,className:"btn btn-outline-info"},"Comments")))),l.a.createElement(x.a,{"aria-label":"Basic example"},l.a.createElement(j,{variant:a.likes.user_liked?"info":"primary",onClick:function(){e.handleLikeClick(a.id)}},"Like ",a.likes.likes),l.a.createElement(j,{variant:"success",onClick:e.handleRetweet.bind(null,a.id)},"Retweet"),("home"===t.page||"user"===t.page)&&l.a.createElement("a",{href:"/"+a.id,className:"btn btn-outline-info"},"Commments"),"detail"===t.page&&a.owner===t.username&&l.a.createElement(j,{variant:"danger",onClick:e.handleDeleteClick.bind(null,a.id)},"Delete"))))},L=a(14);var _=function(e){var t=e.dataset,a=t.feedOwner||t.username,r=Object(n.useState)({}),i=Object(L.a)(r,2),o=i[0],s=i[1];if(Object(n.useEffect)((function(){fetch("api/accounts/".concat(a,"/")).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong!")})).then((function(e){s(e)})).catch((function(e){console.log(e)}))}),[a]),o.user){var c=o.followerings.followers.includes(t.username),u=l.a.createElement(T.a,{xs:5,lg:4,className:"px-0 bg-primary"},l.a.createElement(v.a,{className:"px-2",onSubmit:function(e){e.preventDefault();var t=new FormData(e.target);fetch("api/accounts/".concat(a,"/"),{method:"POST",headers:{HTTP_X_REQUESTED_WITH:"XMLHttpRequest","X-Requested-With":"XMLHttpRequest","X-CSRFToken":N("csrftoken")},body:t}).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong!")})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},l.a.createElement(v.a.Group,{controlId:"formBasicUsername"},l.a.createElement(v.a.Label,null,"Username"),l.a.createElement(v.a.Control,{type:"text",name:"username",defaultValue:o.user.username})),l.a.createElement(v.a.Group,{controlId:"formBasicFirstName"},l.a.createElement(v.a.Label,null,"First Name"),l.a.createElement(v.a.Control,{type:"text",name:"firstName",defaultValue:o.user.first_name})),l.a.createElement(v.a.Group,{controlId:"formBasicLastName"},l.a.createElement(v.a.Label,null,"Last Name"),l.a.createElement(v.a.Control,{type:"text",name:"lastName",defaultValue:o.user.last_name})),l.a.createElement(v.a.Group,{controlId:"formBasicEmail"},l.a.createElement(v.a.Label,null,"Email address"),l.a.createElement(v.a.Control,{type:"email",name:"email",defaultValue:o.user.email})),l.a.createElement(v.a.Group,{controlId:"formBasicBio"},l.a.createElement(v.a.Label,null,"Bio"),l.a.createElement(v.a.Control,{type:"text",name:"bio",defaultValue:o.bio})),l.a.createElement(v.a.Group,{controlId:"formBasicLocation"},l.a.createElement(v.a.Label,null,"Location"),l.a.createElement(v.a.Control,{type:"text",name:"location",defaultValue:o.location})),l.a.createElement(p.a,{variant:"info",type:"submit"},"Submit"))),d=l.a.createElement(T.a,{xs:5,lg:4,className:"px-0 bg-primary"},"Showing tweets of >> ",l.a.createElement("span",{className:"text-white"},a),l.a.createElement("div",{className:"names"},o.user.first_name," ",o.user.last_name),o.bio&&l.a.createElement("div",{className:"bio"},o.bio),o.location&&l.a.createElement("div",{className:"location"},o.location),"user"===t.page&&l.a.createElement(p.a,{variant:c?"danger":"success",onClick:function(e){fetch("api/accounts/adjust-followers/".concat(t.feedOwner,"/"),{method:"POST",headers:{HTTP_X_REQUESTED_WITH:"XMLHttpRequest","X-Requested-With":"XMLHttpRequest","X-CSRFToken":N("csrftoken")}}).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong!")})).then((function(e){s(e)})).catch((function(e){console.log(e)}))}},c?"Unfollow":"Follow"));return l.a.createElement(b.a,{className:"d-flex justify-content-center mb-5"},l.a.createElement(T.a,{xs:5,lg:4,className:"px-0 bg-primary"},l.a.createElement("div",{className:"followers"},"Followers: ",o.followerings.followers.length),l.a.createElement("div",{className:"following"},"Following: ",o.followerings.following.length)),"home"===t.page?u:d)}return l.a.createElement("div",null,"Loading...")};function N(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),n=0;n<a.length;n++){var l=a[n].trim();if(l.substring(0,e.length+1)===e+"="){t=decodeURIComponent(l.substring(e.length+1));break}}return t}var X=a(9);var H=function(e){var t=Object(n.useState)(1),a=Object(L.a)(t,2),r=a[0],i=a[1],o=Object(n.useContext)(w),s=o.next,c=o.prev,u=o.count,d=o.fetchSomeTweets,m=o.tweetsPerPage,f=Math.ceil(u/m),h=function(e){var t=e.target.closest('[role="button"]'),a="next"===t.dataset.func?s:c;d(a),"next"===t.dataset.func?i((function(e){return e+1})):i((function(e){return e-1}))},k=function(e){e.preventDefault();var t=s?s.slice(0,s.length-1):c.slice(0,c.length-1),a="last"===e.target.closest('[role="button"]').dataset.func?"last":"first";"last"===a?t+=f:t.includes("/?page")?t+=1:t=c,d(t),i("first"===a?1:f)};return l.a.createElement("div",{className:"d-flex justify-content-center"},l.a.createElement(X.a,null,l.a.createElement(X.a.First,{onClick:k,"data-func":"first",disabled:1===r}),l.a.createElement(X.a.Prev,{onClick:h,"data-func":"prev",disabled:null===c}),l.a.createElement(X.a.Item,{active:!0},r),l.a.createElement(X.a.Next,{onClick:h,"data-func":"next",disabled:null===s}),l.a.createElement(X.a.Last,{onClick:k,"data-func":"last",disabled:r===f})))},D=a(34);var A=function(e){var t=Object(n.useContext)(w),a=t.dataset,r=t.handleLikeClick,i=t.handleRetweet,o=t.handleTweetAdd,s=t.handleTextArea,c=t.value,u=t.tweets,d=l.a.createElement(l.a.Fragment,null,l.a.createElement(_,{dataset:a}),"true"===a.canTweet&&l.a.createElement(C,{value:c,handleTextArea:s,handleTweetAdd:o}),l.a.createElement(b.a,null,u.map((function(e){return l.a.createElement(O,{key:e.id,tweet:e,handleRetweet:i,handleLikeClick:r,dataset:a})}))),l.a.createElement(H,null)),m=l.a.createElement("div",null,"Hello, thanks for jumping in. Please, consider loging in to see the content!");return l.a.createElement(D.a,null,a.username?d:m)};var I=function(e){var t=Object(n.useContext)(w),a=t.dataset,r=t.tweets,i=t.handleRetweet,o=t.handleLikeClick,s=t.handleDeleteClick;return r.length?l.a.createElement(O,{tweet:r[0],handleRetweet:i,handleLikeClick:o,handleDeleteClick:s,dataset:a}):l.a.createElement("div",null,"Loading")};var q=function(e){var t=Object(n.useContext)(w).dataset.page;return l.a.createElement(l.a.Fragment,null,l.a.createElement(E,null),"detail"===t&&l.a.createElement(I,null),("home"===t||"user"===t)&&l.a.createElement(A,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var P=document.getElementById("root");P&&i.a.render(l.a.createElement(k,P.dataset,l.a.createElement(q,null)),P),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.a6e311ea.chunk.js.map